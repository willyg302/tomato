!function t(e,n,r){function i(s,o){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!o&&u)return u(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[s].exports}for(var a="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){var r,i,a,s;r=t("./audio-source.coffee"),i=t("./soundcloud-loader.coffee"),a=t("./visualizer.coffee"),plyr.setup({controls:["restart","play","current-time","duration","mute","volume"]}),s=function(t){var e,n,r,i,a,s;return a=t.sound,document.getElementById("infoImage").setAttribute("src",null!=(i=a.artwork_url)?i:a.user.avatar_url),e=document.createElement("a"),e.setAttribute("href",a.user.permalink_url),e.innerHTML=a.user.username,n=document.getElementById("infoArtist"),n.innerHTML="",n.appendChild(e),s=document.createElement("a"),s.setAttribute("href",a.permalink_url),s.innerHTML="playlist"===a.kind?a.tracks[t.streamPlaylistIndex].title:a.title,r=document.getElementById("infoTrack"),r.innerHTML="",r.appendChild(s),window.location.hash=a.permalink_url.substr(22)},window.onload=function(){var t,e,n,o,u,l,c;return document.body.className="",o=document.getElementById("player"),n=new i(o),u=new r(o),c=new a,c.init({container:"visualizer",audioSource:u}),e=function(t){return n.loadStream(t,function(t){return u.playStream(t),s(n),document.body.className="playing"},function(){})},window.location.hash&&e("https://soundcloud.com/"+window.location.hash.substr(1)),l=document.getElementById("submit"),l.onkeypress=function(t){var n;switch(t.stopPropagation(),t.keyCode){case 10:case 13:return n=l.value,l.value="",e(n)}},t=function(t){switch(t.keyCode){case 32:return n.directStream("toggle")}},window.addEventListener("keypress",t,!1)}},{"./audio-source.coffee":2,"./soundcloud-loader.coffee":3,"./visualizer.coffee":4}],2:[function(t,e,n){var r;r=function(){function t(t){var e;this.player=t,e=new(window.AudioContext||window.webkitAudioContext),this.analyser=e.createAnalyser(),e.createMediaElementSource(this.player).connect(this.analyser),this.analyser.connect(e.destination),this.volume=0,this.streamData=new Uint8Array(this.analyser.frequencyBinCount),console.log(this.analyser.frequencyBinCount)}return t.prototype._sampleAudioStream=function(){var t,e,n;for(this.analyser.getByteFrequencyData(this.streamData),n=0,t=e=0;79>=e;t=++e)n+=this.streamData[t];return this.volume=n},t.prototype.playStream=function(t){return this.player.addEventListener("ended",function(){return this.directStream("coasting")}),this.player.setAttribute("src",t),this.player.play(),setInterval(function(t){return function(){return t._sampleAudioStream()}}(this),20)},t}(),e.exports=r},{}],3:[function(t,e,n){var r;r=function(){function t(t,e){var n;this.player=t,this.updater=e,n="116aeada3811cb64c5bbf30c82303e0d",this.client_id=n.split("").map(function(t){return((parseInt(t,16)+13)%16).toString(16)}).join(""),this.sound={},this.errorMessage=""}return t.prototype.loadStream=function(t,e,n){return SC.initialize({client_id:this.client_id}),SC.get("/resolve",{url:t},function(t){return function(r){var i;return r.errors?(t.errorMessage="Something bad happened",n()):(t.sound=r,"playlist"===r.kind?(t.streamPlaylistIndex=0,i=t.sound.tracks[t.streamPlaylistIndex].stream_url+"?client_id="+t.client_id):(t.sound=r,i=t.sound.stream_url+"?client_id="+t.client_id),e(i))}}(this))},t.prototype.directStream=function(t){return"toggle"===t?this.player.paused?this.player.play():this.player.pause():"playlist"===this.sound.kind&&("coasting"===t?this.streamPlaylistIndex++:"forward"===t?this.streamPlaylistIndex>=this.sound.track_count-1?this.streamPlaylistIndex=0:this.streamPlaylistIndex++:this.streamPlaylistIndex<=0?this.streamPlaylistIndex=this.sound.track_count-1:this.streamPlaylistIndex--,this.streamPlaylistIndex>=0&&this.streamPlaylistIndex<=this.sound.track_count-1)?(this.player.setAttribute("src",this.streamUrl()),this.player.play()):void 0},t}(),e.exports=r},{}],4:[function(t,e,n){var r,i=function(t,e){return function(){return t.apply(e,arguments)}};r=function(){function t(){this._draw=i(this._draw,this)}return t.prototype.init=function(t){return this.audioSource=t.audioSource,this.canvas=document.createElement("canvas"),this.canvas.width=384,this.canvas.height=384,this.context=this.canvas.getContext("2d"),document.getElementById(t.container).appendChild(this.canvas),this._draw()},t.prototype._draw=function(){var t,e,n;for(this.context.clearRect(0,0,384,384),this.context.fillStyle="#000000",this.context.lineCap="round",t=e=0;127>=e;t=++e)this.context.save(),this.context.translate(192,192),n=this.audioSource.streamData[t],this.context.rotate(-Math.PI*(t+95.3)/79.5),this.context.fillRect(0,112,2,n/4),this.context.restore();return window.requestAnimationFrame(this._draw)},t}(),e.exports=r},{}]},{},[1]);